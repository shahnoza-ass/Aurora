let canvas = document.getElementById("pong");
let ctx = canvas.getContext("2d");

let ballRadius = 10;
let x = canvas.width / 2;
let y = canvas.height / 2;
let dx = 4;
let dy = -4;

let paddleHeight = 100;
let paddleWidth = 10;
let paddleY = (canvas.height - paddleHeight) / 2;
let rightPaddleY = (canvas.height - paddleHeight) / 2;
let paddleSpeed = 20;

let upPressed = false;
let downPressed = false;

function keyDownHandler(e) {
  if (e.key === "ArrowUp") {
    upPressed = true;
  } else if (e.key === "ArrowDown") {
    downPressed = true;
  }
}

function keyUpHandler(e) {
  if (e.key === "ArrowUp") {
    upPressed = false;
  } else if (e.key === "ArrowDown") {
    downPressed = false;
  }
}

function drawBall() {
  ctx.beginPath();
  ctx.arc(x, y, ballRadius, 0, Math.PI * 2);
  ctx.fillStyle = "#0095DD";
  ctx.fill();
  ctx.closePath();
}

function drawPaddles() {
  ctx.beginPath();
  ctx.rect(0, paddleY, paddleWidth, paddleHeight); // Left paddle
  ctx.rect(canvas.width - paddleWidth, rightPaddleY, paddleWidth, paddleHeight); // Right paddle
  ctx.fillStyle = "#0095DD";
  ctx.fill();
  ctx.closePath();
}

function moveBall() {
  x += dx;
  y += dy;

  if (y + dy < ballRadius || y + dy > canvas.height - ballRadius) {
    dy = -dy;
  }

  if (x + dx < paddleWidth) {
    if (y > paddleY && y < paddleY + paddleHeight) {
      dx = -dx;
    } else {
      resetBall();
    }
  } else if (x + dx > canvas.width - paddleWidth) {
    if (y > rightPaddleY && y < rightPaddleY + paddleHeight) {
      dx = -dx;
    } else {
      resetBall();
    }
  }
}

function resetBall() {
  x = canvas.width / 2;
  y = canvas.height / 2;
  dx = -dx;
  dy = 4;
}

function movePaddles() {
  if (upPressed && paddleY > 0) {
    paddleY -= paddleSpeed;
  } else if (downPressed && paddleY < canvas.height - paddleHeight) {
    paddleY += paddleSpeed;
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBall();
  drawPaddles();
  moveBall();
  movePaddles();
  requestAnimationFrame(draw);
}

document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);

function startPong() {
  document.getElementById("pong-container").style.display = "block";
  document.getElementById("whackAMole-container").style.display = "none";
  draw();
}
